rules:

  - rule_id: 0
    sender:
      senderName: "A.my_namespace"
      senderType: "workload"
    receiver:
      receiverName: "B.my_namespace"
      receiverType: "workload"
    protocol: "*"
    resource:
      resourceType: path
      resourceName: "/*"
    operation: "*"
    decision: allow
    conditions:
      AND:

      - ANY:
          parentJsonpathAttribute: "jsonpath:$.alerts[:]"
          condition:
            attribute: jsonpath:$RELATIVE.alert_type
            method: EQ
            value: "new process"
            returnValueJsonpath:
              newProcessId: jsonpath:$RELATIVE.process_id

      - ANY:
            parentJsonpathAttribute: "jsonpath:$.alerts[:]"
            condition:
              AND:
              - attribute: jsonpath:$RELATIVE.alert_type
                method: EQ
                value: "high cpu"
              - attribute: jsonpath:$RELATIVE.process_id
                method: IN
                value: "#newProcessId"

