rules:

  - rule_id: 0
    sender:
      senderName: "A.my_namespace"
      senderType: "workload"
    receiver:
      receiverName: "B.my_namespace"
      receiverType: "workload"
    protocol: "*"
    resource:
      resourceType: "*"
      resourceName: "*"
    operation: "*"
    conditions:
      AND:
      -  attribute: "jsonpath:$.spec.template.spec.containers[*].env[?(@.name=='http_proxy')].value"
         method: EX
         value: ""
      - "attribute": "jsonpath:$.spec.template.spec.containers[*].env[?(@.name=='http_proxy')].value"
        "method": "NEQ"
        "value": "http://xxx.yyy.prod:3128"

    decision: block
